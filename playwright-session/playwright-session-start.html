<script type="text/javascript">
    RED.nodes.registerType('playwright-session-start', {
        category: 'function',
        color: '#4CAF50',
        defaults: {
            name: {value: ""},
            url: {value: "", required: false},
            browser_options: {value: "{}", required: false}
        },
        inputs: 1,
        outputs: 2,
        outputLabels: ["–£—Å–ø–µ—Ö", "–û—à–∏–±–∫–∞"],
        icon: "font-awesome/fa-play-circle",
        label: function() {
            return this.name || "–ù–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é";
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –æ–ø—Ü–∏–π –±—Ä–∞—É–∑–µ—Ä–∞
            if (!this.browser_options) {
                this.browser_options = "{}";
            }
        }
    });
</script>

<script type="text/html" data-template-name="playwright-session-start">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> –ù–∞–∑–≤–∞–Ω–∏–µ</label>
        <input type="text" id="node-input-name" placeholder="–ù–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é">
    </div>
    
    <div class="form-row">
        <label for="node-input-url"><i class="fa fa-globe"></i> URL (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
        <input type="text" id="node-input-url" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏">
        <div class="form-tips">
            <strong>üõ°Ô∏è –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ª—É—á—à–µ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º!</strong><br>
            –°–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ "stealth_mode", –∑–∞—Ç–µ–º "navigate".<br>
            –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –¥–µ—Ç–µ–∫—Ü–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.
        </div>
    </div>
    
    <div class="form-row">
        <label for="node-input-browser_options"><i class="fa fa-cog"></i> –û–ø—Ü–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞</label>
        <input type="text" id="node-input-browser_options" placeholder='{"headless": true}'>
        <div class="form-tips">
            <strong>JSON –æ–ø—Ü–∏–∏ –¥–ª—è Playwright –±—Ä–∞—É–∑–µ—Ä–∞</strong><br>
            –ù–∞–ø—Ä–∏–º–µ—Ä: {"headless": false, "slowMo": 100}
        </div>
    </div>
</script>

<script type="text/html" data-help-name="playwright-session-start">
    <p>üü¢ <strong>–ù–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é –±—Ä–∞—É–∑–µ—Ä–∞</strong></p>
    
    <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
    <p>üõ°Ô∏è –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –±—Ä–∞—É–∑–µ—Ä–∞ –ë–ï–ó –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "stealth_mode" ‚Üí "navigate" –¥–ª—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏.</p>
    
    <h3>–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
    <dl class="message-properties">
        <dt>url <span class="property-type">—Å—Ç—Ä–æ–∫–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></dt>
        <dd>–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ! –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –∏ –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ —Å—Ç–µ–ª—Å-—Ä–µ–∂–∏–º –ø–µ—Ä–µ–¥ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π.</dd>
        
        <dt>browser_options <span class="property-type">–æ–±—ä–µ–∫—Ç</span></dt>
        <dd>–û–ø—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞ (headless, slowMo, etc.)</dd>
    </dl>

    <h3>–í—ã—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
    <dl class="message-properties">
        <dt>session_id <span class="property-type">—Å—Ç—Ä–æ–∫–∞</span></dt>
        <dd>–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞</dd>
        
        <dt>browser_ready <span class="property-type">boolean</span></dt>
        <dd>true - –±—Ä–∞—É–∑–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</dd>
        
        <dt>initial_url <span class="property-type">—Å—Ç—Ä–æ–∫–∞</span></dt>
        <dd>URL –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –æ—Ç–∫—Ä—ã—Ç</dd>
        
        <dt>payload.success <span class="property-type">boolean</span></dt>
        <dd>–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏</dd>
    </dl>

    <h3>–í—ã—Ö–æ–¥—ã</h3>
    <ol class="node-ports">
        <li><strong>–£—Å–ø–µ—Ö:</strong> –°–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ</li>
        <li><strong>–û—à–∏–±–∫–∞:</strong> –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏</li>
    </ol>

    <h3>–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π</h3>
    <pre>
üõ°Ô∏è –ü–†–ê–í–ò–õ–¨–ù–´–ô –ø–æ—Ç–æ–∫ –¥–ª—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏:

1. [inject] ‚Üí [session-start] (–ë–ï–ó URL!)
2. [session-action: stealth_mode] 
3. [session-action: navigate ‚Üí https://bot.sannysoft.com]
4. [session-action: test_bot_detection]
5. [session-end]

// –í—ã—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ session-start:
{
  "session_id": "sess_1672531200000_abc123",
  "browser_ready": true,
  "initial_url": null,
  "payload": {
    "success": true,
    "message": "–ë—Ä–∞—É–∑–µ—Ä —Å–æ–∑–¥–∞–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ stealth_mode ‚Üí navigate"
  }
}
    </pre>
    
    <h3>‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û –¥–ª—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏</h3>
    <ul>
        <li>üõ°Ô∏è <strong>–ù–ï —É–∫–∞–∑—ã–≤–∞–π—Ç–µ URL</strong> –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–æ–¥—ã!</li>
        <li>üéØ <strong>–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> session-start ‚Üí stealth_mode ‚Üí navigate</li>
        <li>‚ùå <strong>–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:</strong> session-start(url) - —Å–∞–π—Ç –∑–∞—Å–µ—á–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é</li>
        <li>‚úÖ <strong>–ü–†–ê–í–ò–õ–¨–ù–û:</strong> session-start() ‚Üí stealth_mode ‚Üí navigate(url)</li>
        <li>üîó <strong>session_id</strong> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –Ω–æ–¥–∞–º</li>
        <li>‚è∞ –°–µ—Å—Å–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</li>
    </ul>
</script> 